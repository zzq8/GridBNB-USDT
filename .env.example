# === 多交易所配置示例 ===
# 复制此文件为 .env 并填入您的实际API密钥

# ============================================================================
# 交易所选择
# ============================================================================
# 当前使用的交易所（支持: binance, okx）
EXCHANGE=binance

# ============================================================================
# 测试网/模拟盘配置
# ============================================================================
# 是否使用测试网（true=模拟盘测试, false=实盘交易）
# 测试网使用测试币，不会影响真实资金，适合调试和学习
TESTNET_MODE=false

# ============================================================================
# Binance 配置（实盘）
# ============================================================================
BINANCE_API_KEY=your_binance_api_key_here
BINANCE_API_SECRET=your_binance_api_secret_here

# ============================================================================
# Binance 测试网配置（可选，仅在 TESTNET_MODE=true 时使用）
# ============================================================================
# 测试网申请地址: https://testnet.binance.vision/
# 测试网端点: https://testnet.binance.vision
# 注意：测试网API密钥与实盘不同，需要单独申请
# BINANCE_TESTNET_API_KEY=your_testnet_api_key_here
# BINANCE_TESTNET_API_SECRET=your_testnet_api_secret_here

# ============================================================================
# OKX 配置（实盘）
# ============================================================================
# 注意：OKX需要额外的passphrase
OKX_API_KEY=your_okx_api_key_here
OKX_API_SECRET=your_okx_api_secret_here
OKX_PASSPHRASE=your_okx_passphrase_here

# ============================================================================
# OKX 测试网配置（可选，仅在 TESTNET_MODE=true 时使用）
# ============================================================================
# OKX Demo环境需要单独申请API密钥
# 申请地址: https://www.okx.com/account/my-api
# 注意：选择"Demo Trading"模式创建API密钥
# OKX_TESTNET_API_KEY=your_okx_demo_api_key_here
# OKX_TESTNET_API_SECRET=your_okx_demo_api_secret_here
# OKX_TESTNET_PASSPHRASE=your_okx_demo_passphrase_here

# ============================================================================
# 功能开关
# ============================================================================
# 是否启用理财功能（Binance Simple Earn / OKX Earn）
ENABLE_SAVINGS_FUNCTION=true

# ============================================================================
# 网络配置
# ============================================================================
# HTTP代理（可选，格式: http://host:port 或 socks5://host:port）
HTTP_PROXY=

# API超时时间（毫秒）
API_TIMEOUT=60000

# ============================================================================
# 交易策略配置
# ============================================================================
# 交易对（逗号分隔，例如: BNB/USDT,ETH/USDT）
SYMBOLS=BNB/USDT

# 初始网格大小（百分比）
INITIAL_GRID=2.0

# 最小交易金额（USDT）
MIN_TRADE_AMOUNT=20.0

# 按交易对设置的初始参数（JSON格式）
INITIAL_PARAMS_JSON={"BNB/USDT": {"initial_base_price": 600.0, "initial_grid": 2.0}}

# ============================================================================
# 风控配置
# ============================================================================
# 最大仓位比例（全局默认值）
MAX_POSITION_RATIO=0.9

# 最小仓位比例（底仓保护，全局默认值）
MIN_POSITION_RATIO=0.1

# 🆕 交易对特定仓位限制（JSON格式，Issue #51）
# 允许为不同交易对设置不同的仓位上下限，优先级高于全局限制
# 使用场景：
#   1. 持有某些币种领取空投（如BNB），需要保持较高底仓（避免卖空）
#   2. 不同币种的风险偏好不同，灵活配置仓位限制
#   3. 核心资产保持稳定仓位，其他资产可以更激进
#
# 配置格式: {"交易对": {"min": 最小仓位比例, "max": 最大仓位比例}}
# 比例范围: 0-1 之间的小数（例如 0.20 = 20%）
#
# 示例1: BNB用于空投需保持20%-80%仓位，ETH可以更灵活5%-95%
# POSITION_LIMITS_JSON={"BNB/USDT": {"min": 0.20, "max": 0.80}, "ETH/USDT": {"min": 0.05, "max": 0.95}}
#
# 示例2: 仅配置BNB的特殊限制，其他交易对使用全局限制
# POSITION_LIMITS_JSON={"BNB/USDT": {"min": 0.30, "max": 0.70}}
#
# 留空则所有交易对使用全局限制（MAX_POSITION_RATIO和MIN_POSITION_RATIO）
POSITION_LIMITS_JSON=

# ============================================================================
# 止损配置 (Stop Loss Settings) 🆕
# ============================================================================
# 是否启用止损机制（true=启用, false=禁用）
# ⚠️ 重要：启用后可有效控制极端行情风险，建议新手和中小资金用户启用
# 止损触发后会自动平仓并停止该交易对的交易
ENABLE_STOP_LOSS=false

# 价格止损比例 (%)
# 当价格相对基准价下跌超过此比例时触发止损
# 推荐值: 10-20%（保守：10%，中等：15%，激进：20%）
# 设置为 0 则禁用价格止损
# 示例: 基准价 600 USDT，设置 15%，则跌至 510 USDT 时触发止损
STOP_LOSS_PERCENTAGE=15.0

# 回撤止盈比例 (%)
# 当盈利从最高点回撤超过此比例时触发止盈，锁定利润
# 推荐值: 15-30%（保守：15%，中等：20%，激进：30%）
# 设置为 0 则禁用回撤止盈
# 示例: 最高盈利 +200 USDT，设置 20%，当盈利回落至 +160 USDT 时触发止盈
TAKE_PROFIT_DRAWDOWN=20.0

# ============================================================================
# 趋势识别配置 (Trend Detection Settings) 🆕
# ============================================================================
# 是否启用趋势识别（true=启用, false=禁用）
# 启用后，系统会根据市场趋势自动调整交易策略
# 强上涨趋势时减少卖出，强下跌趋势时减少买入，避免牛市踏空和熊市接刀
# ⚠️ 建议启用，可显著提升策略适应性
ENABLE_TREND_DETECTION=true

# EMA短周期（建议: 10-30）
# 用于快速捕捉价格变化，判断短期趋势
TREND_EMA_SHORT=20

# EMA长周期（建议: 30-100）
# 用于判断长期趋势方向，需要大于短周期
TREND_EMA_LONG=50

# ADX计算周期（建议: 14）
# ADX是衡量趋势强度的标准指标，通常使用14周期
TREND_ADX_PERIOD=14

# 强趋势阈值（0-100，建议: 50-70）
# 超过此阈值才认为是强趋势，会触发交易限制（暂停买入或卖出）
# 保守：50（较宽松，更频繁触发），平衡：60（推荐），激进：70（较严格）
TREND_STRONG_THRESHOLD=60.0

# 趋势检测间隔（秒，建议: 300-600）
# 趋势判断的缓存时间，避免过于频繁计算
# 较短间隔响应更快但计算开销更大
TREND_DETECTION_INTERVAL=300

# ============================================================================
# 通知配置
# ============================================================================
# PushPlus通知Token（可选）
PUSHPLUS_TOKEN=your_pushplus_token

# Telegram通知（可选）
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Webhook通知（可选）
WEBHOOK_URL=

# ============================================================================
# AI策略配置（可选）
# ============================================================================
# 是否启用AI辅助交易
AI_ENABLED=false

# AI提供商（openai / anthropic）
AI_PROVIDER=openai

# AI模型
AI_MODEL=gpt-4-turbo

# AI API密钥
AI_API_KEY=your_openai_api_key

# OpenAI自定义Base URL（可选，用于第三方API）
AI_OPENAI_BASE_URL=

# AI置信度阈值（0-100）
AI_CONFIDENCE_THRESHOLD=70

# AI触发间隔（秒）
AI_TRIGGER_INTERVAL=900

# 每日最大AI调用次数
AI_MAX_CALLS_PER_DAY=100

# AI失败时是否回退到网格策略
AI_FALLBACK_TO_GRID=true

# ============================================================================
# 调试配置
# ============================================================================
# 调试模式（会输出详细日志）
DEBUG_MODE=false

# 日志级别（可选值: DEBUG, INFO, WARNING, ERROR, CRITICAL）
# 支持字符串或对应的整数值（10=DEBUG, 20=INFO, 30=WARNING, 40=ERROR, 50=CRITICAL）
# 建议生产环境使用 INFO，调试时使用 DEBUG
LOG_LEVEL=INFO

# ============================================================================
# Web监控配置
# ============================================================================
# Web界面用户名和密码（可选）
WEB_USER=admin
WEB_PASSWORD=your_secure_password_here

# ============================================================================
# 理财精度配置（JSON格式）
# ============================================================================
# 不同资产的理财操作精度
SAVINGS_PRECISIONS={"USDT": 2, "BNB": 6, "DEFAULT": 8}

# ============================================================================
# 高级策略参数（JSON格式）
# ============================================================================

# 网格参数（JSON格式）
# initial: 初始网格大小, min: 最小网格大小, max: 最大网格大小
GRID_PARAMS_JSON={"initial": 2.0, "min": 1.0, "max": 4.0}

# 连续网格调整参数（JSON格式）
# base_grid: 基础网格大小, center_volatility: 中心波动率, sensitivity_k: 敏感度系数
GRID_CONTINUOUS_PARAMS_JSON={"base_grid": 2.5, "center_volatility": 0.25, "sensitivity_k": 10.0}

# 动态时间间隔参数（JSON格式，根据市场波动率自动调整交易间隔）
# default_interval_hours: 默认交易间隔（小时）
# volatility_to_interval_hours: 波动率区间映射，波动率越高交易频率越高
# 示例: 波动率0-10%时每1小时交易一次，10-20%时每0.5小时，20-30%时每0.25小时，>30%时每0.125小时
DYNAMIC_INTERVAL_PARAMS_JSON={"default_interval_hours":1.0,"volatility_to_interval_hours":[{"range":[0,0.10],"interval_hours":1.0},{"range":[0.10,0.20],"interval_hours":0.5},{"range":[0.20,0.30],"interval_hours":0.25},{"range":[0.30,999],"interval_hours":0.125}]}

# 是否启用成交量加权（根据成交量调整交易决策权重）
ENABLE_VOLUME_WEIGHTING=true

# 初始本金（用于计算仓位比例和风险管理，单位: USDT）
# 设置为0或不设置时，系统会在启动时自动检测账户总资产
# 建议：首次运行设置为0自动检测，之后可固定为启动时的总资产以便准确计算盈亏
INITIAL_PRINCIPAL=0
